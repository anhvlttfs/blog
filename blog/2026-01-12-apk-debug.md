---
slug: apk-debugging
title: Enable debugging mode on Android Application Package & Start Debugging with Android Studio
author: Vo Luu Tuong Anh
author_title: VLTA of @TheFlightSims
author_url: https://github.com/anhvlttfs
author_image_url: https://avatars.githubusercontent.com/u/176574466?v=4
tags: [android, android-studio, reverse-engineering]
---

## Prepare environment

* [Android Studio](https://developer.android.com/studio) with SDKs and toolchain

> It is recommended to install development packages
>
> * SDKs: **25 (Android 7.1.1)**, **27 (Android 8.1)**, **29 (Android 10.0)**, **31 (Android 12.0)**, **32 (Android 12L)**, **33 (Android 13)**, **34 (Android 14)**, **35 (Android 15)**, and **36 (Android 16)**. Note that you may need the emulator base image, and may not install Android SDK packages that not included within the APK supprted range.
> * Toolchains: **Android SDK Build-Tools**, **Android SDK Command-line Tools (latest)**, **Android Emulator (all)**, **Google Play libraries and services (all, except the Instant Development SDK)**
> * Plugins: Database Nagivator (to open sqlite)

* [Java Development Kit 8 (required), 11 (optional), 17 (optional), 21 (required), and 25 (optional)](https://www.oracle.com/asean/java/technologies/downloads/)
* [apktool.java](https://apktool.org/) with [JRE 8](https://www.oracle.com/asean/java/technologies/javase/javase8-archive-downloads.html)
* A physical Android device with a physical SIM and SD card (required), and a emualted Android device (not required)
* A history-tracable comamnd line environment, such as *Powershell 7 (on Windows)*, or *zsh (on Ubuntu/Kali Linux)*

### Start adding the `$PATH` with the debugging packages

Following paths must be added into the path in order to use the application packages:

* Java Development Kit 21 (`/bin` folder), to use `keytool` (recommend to add into the system `$PATH` variable)
* Android platform tools (usually in `Android/Sdk/platform-tools`) to use `adb`
* Android Build Tools (take your pick, usually in `Android/Sdk/build-tools`, not required)

### Installing device driver for ADB

Visit this page to install [ADB device driver](https://developer.android.com/studio/run/win-usb)  

## Repack the Android Application package with debuggable flag

1. Using `apktool.java` to unpack the Android application package

    ```bash
   apktool d -o <output-directory> <path-to-your-apk-file>
    ```

2. Once the unpacking is done, try adding the debuggable flag into the `AndroidManifest.xml`, under the `<output-directory>` path

    ```xml
    <application android:debuggable="true" ...>
        <!-- other application elements -->
    </application>
    ```

3. Recompile the APK

    ```bash
    apktool b -o <path-to-your-new-apk-file> <output-directory>
    ```

## Resign the Android Application Package (with custom signing key, easy mode)

1. First, create a custom signing key

    ```bash
   keytool -genkey -v -keystore <path-to-the-key-but-accessible> -alias alias_name -keyalg RSA -keysize <key-length> -validity <valid-days>
    ```

2. Use the just-created signing key, to sign the Apk

    ```bash
   apksigner sign -ks <path-to-the-key-but-accessible> --ks-pass pass:android <path-to-your-new-apk-file> alias_name
    ```

## Try installing new Android Application Package

Using the `adb`, try to install the new application package

```shell
adb install <path-to-your-new-apk-file>
```

## Common errors

### `INSTALL_PARSE_FAILED_NO_CERTIFICATES`

Try sign the APK and resign it in [Resign the Android Application Package](#resign-the-android-application-package-with-custom-signing-key-easy-mode)

### `INSTALL_FAILED_MISSING_SPLIT`

It usually comes when the application package is packed with multiple application (e.g. it is packed in a XAPK) for multiple ABIs, where the base package just does not provide the proper way to let the Android handle the application.

If you are the developer/tester, try installing the APK with `install-multiple` flags

If you obtain the hacker who just need hacking, you may need to download the APK from Application Store, such as ApkCombo. Once you've downloaded, try unpack the XAPK, and start enable the debugging from the beginning.

> Note:
>
> * You may need to resign both base and split packages, see the signing Android application package above
> * It is recommended to **check for the device ABI** before proceeding any further step. See `INSTALL_FAILED_NO_MATCHING_ABIS` below for detailed.

### `INSTALL_FAILED_NO_MATCHING_ABIS`

It appears when your application is not compatible with the device architecture.

Try to find an package that is compatible with your device

> Note:
>
> * If this is a splited application package, just keep the base application package and find the matching ABI for library, it is not needed to redo all things

### `INSTALL_FAILED_UPDATE_INCOMPATIBLE`

It is happened when your application package is already installed and it has a different key, compare to the modified application package.

Try to **uninstall** it with `pm` of `adb shell`, or using your own application manager inside your device

```bash
(base) sh@DESKTOP-O9NIMTA:~$ adb shell
android:/ $ pm list packages | grep "<application-name-parts>"
android:/ $ pm uninstall <the-application-package-you-just-found>
```
